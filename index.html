<!DOCTYPE html>
<html>

<head>
    <title>Web GIS Kaupaten Banjarnegara</title>

    <!--Plugins CSS dan Script-->

    <link rel="stylesheet" href="src/leaflet.css">
    <link rel="stylesheet" href="src/css/bootstrap.css">
    <link rel="stylesheet" href="src/plugins/L.Control.MousePosition.css">
    <link rel="stylesheet" href="src/plugins/L.Control.Sidebar.css">
    <link rel="stylesheet" href="src/plugins/Leaflet.PolylineMeasure.css">
    <link rel="stylesheet" href="src/plugins/easy-button.css">
    <link rel="stylesheet" href="src/plugins/leaflet-styleeditor/css/Leaflet.StyleEditor.css">
    <link rel="stylesheet" href="src/css/font-awesome.min.css">
    <link rel="stylesheet" href="src/plugins/leaflet.awesome-markers.css">
    <link rel="stylesheet" href="src/plugins/leaflet-mapkey/MapkeyIcons.css">
    <link rel="stylesheet" href="src/plugins/leaflet-mapkey/L.Icon.Mapkey.css">
    <link rel="stylesheet" href="src/plugins/MarkerCluster.css">
    <link rel="stylesheet" href="src/plugins/MarkerCluster.Default.css">
    <link rel="stylesheet" href="src/plugins/leaflet-legend.css">
    <link rel="stylesheet" href="src/jquery-ui.min.css">

    <script src="src/leaflet-src.js"></script>
    <script src="src/leaflet.js"></script>
    <script src="src/jquery-3.2.0.min.js"></script>
    <script src="src/plugins/L.Control.MousePosition.js"></script>
    <script src="src/plugins/L.Control.Sidebar.js"></script>
    <script src="src/plugins/Leaflet.PolylineMeasure.js"></script>
    <script src="src/plugins/easy-button.js"></script>
    <script src="src/plugins/leaflet-providers.js"></script>
    <script src="src/plugins/leaflet-styleeditor/javascript/Leaflet.StyleEditor.js"></script>
    <script src="src/plugins/leaflet-styleeditor/javascript/Leaflet.StyleForms.js"></script>
    <script src="src/plugins/leaflet.ajax.min.js"></script>
    <script src="src/plugins/leaflet.sprite.js"></script>
    <script src="src/plugins/leaflet.awesome-markers.min.js"></script>
    <script src="src/plugins/leaflet-mapkey/L.Icon.Mapkey.js"></script>
    <script src="src/plugins/leaflet.markercluster.js"></script>
    <script src="src/plugins/leaflet.geometryutil.js"></script>
    <script src="src/plugins/leaflet-legend.js"></script>
    <script src="src/jquery-ui.min.js"></script>
    <script src="src/turf.min.js"></script>

    <!-- Begin Leaflet.Draw -->

    <script src="src/plugin/leaflet-draw/Leaflet.draw.js"></script>
    <script src="src/plugin/leaflet-draw/Leaflet.Draw.Event.js"></script>
    <link rel="stylesheet" href="src/plugin/leaflet-draw/leaflet.draw.css"/>

    <script src="src/plugin/leaflet-draw/Toolbar.js"></script>
    <script src="src/plugin/leaflet-draw/Tooltip.js"></script>

    <script src="src/plugin/leaflet-draw/ext/GeometryUtil.js"></script>
    <script src="src/plugin/leaflet-draw/ext/LatLngUtil.js"></script>
    <script src="src/plugin/leaflet-draw/ext/LineUtil.Intersect.js"></script>
    <script src="src/plugin/leaflet-draw/ext/Polygon.Intersect.js"></script>
    <script src="src/plugin/leaflet-draw/ext/Polyline.Intersect.js"></script>
    <script src="src/plugin/leaflet-draw/ext/TouchEvents.js"></script>

    <script src="src/plugin/leaflet-draw/draw/DrawToolbar.js"></script>
    <script src="src/plugin/leaflet-draw/draw/handler/Draw.Feature.js"></script>
    <script src="src/plugin/leaflet-draw/draw/handler/Draw.SimpleShape.js"></script>
    <script src="src/plugin/leaflet-draw/draw/handler/Draw.Polylane.js"></script>
    <script src="src/plugin/leaflet-draw/draw/handler/Draw.Circle.js"></script>
    <script src="src/plugin/leaflet-draw/draw/handler/Draw.Marker.js"></script>
    <script src="src/plugin/leaflet-draw/draw/handler/Draw.Polygon.js"></script>
    <script src="src/plugin/leaflet-draw/draw/handler/Draw.Rectangle.js"></script>

    <script src="src/plugin/leaflet-draw/edit/EditToolbar.js"></script>
    <script src="src/plugin/leaflet-draw/edit/handler/EditToolbar.Edit.js"></script>
    <script src="src/plugin/leaflet-draw/edit/handler/EditToolbar.Delete.js"></script>

    <script src="src/plugin/leaflet-draw/Control.Draw.js"></script>

    <script src="src/plugin/leaflet-draw/edit/handler/Edit.Poly.js"></script>
    <script src="src/plugin/leaflet-draw/edit/handler/Edit.SimpleShape.js"></script>
    <script src="src/plugin/leaflet-draw/edit/handler/Edit.Circle.js"></script>
    <script src="src/plugin/leaflet-draw/edit/handler/Edit.Rectangle.js"></script>
    <script src="src/plugin/leaflet-draw/edit/handler/Edit.Marker.js"></script>

    <!--Menu Bar Sebelah Kiri-->
    <style>
        #mapdiv {
            height: 100vh;
        }

        #divRumah {
            background-color: beige;
        }

        #divInfrastruktur {
            background-color: darkorange;
        }

        .errorMsg {
            padding: 0;
            text-align: center;
            background-color: darksalmon;
        }

        .col-xs-12,
        .col-xs-6,
        .col-xs-4 {
            padding: 3px;
        }
    </style>
</head>

<body>

    <!--Side Bar-->
    <div id="side-bar" class="col-md-3">
        <!--Button Locate-->
        <button id='btnLocate' class='btn btn-primary btn-block'><b>Web Map Kabupaten Banjarnegara</b></button><br>

        <div id="divFilterRumah" class="col-xs-12">
            <div class="col-xs-3">
                <table id="headLogos">
                    <tbody>
                        <tr>
                            <td align="right">
                                <img id="banjarnegaraLogo" width="100%" src="src/images/Banjarnegara.png">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>


            <div class="col-xs-2">
                <br>
                <p><i>dan</i></p>
            </div>

            <div class="col-xs-3">
                <table id="headLogos">
                    <tbody>
                        <tr>
                            <td align:left>

                                <img id="upbLogo" width="200" src="src/images/logo upb.png">
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <button id="btnShowLegend" class='btn btn-primary btn-block'><b>LEGENDA</b></button>

        <div id="legend">
            <div id="lgndRumah">

                <h4 class="text-left">Rumah<i id="btnRumah" class="fa fa-server"></i></h4>
                <div id="lgndRumahDetail">
                    <svg height="60" width="100%">
                        <circle cx="25" cy="15" r="10"
                            style="stroke-width: 4; stroke:deepink; fill:chartreuse; fill-opacity:0.5;" />
                        <text x="50" y="20" style="font-family:sans-serif; font-size: 16px;">Rumah Tidak Layak Huni
                            (RTLH)"</text>
                        <circle cx="25" cy="45" r="10"
                            style="stroke-width: 4; stroke: chartreuse; fill:rgb(238, 9, 9); fill-opacity:0.5;" />
                        <text x="50" y="50" style="font-family:sans-serif; font-size: 16px;">Rumah Layak Huni</text>
                    </svg>
                </div>
            </div>


            <div id="lgndSekolah">

                <h4 class="text-left">Sekolah<i id="btnSekolah" class="fa fa-server"></i></h4>
                <div id="lgndSekolahDetail">
                    <svg height="60" width="100%">
                        <circle cx="25" cy="15" r="10"
                            style="stroke-width: 4; stroke:deepink; fill:chartreuse; fill-opacity:0.5;" />
                        <text x="50" y="20" style="font-family:sans-serif; font-size: 16px;">Negri</text>
                        <circle cx="25" cy="45" r="10"
                            style="stroke-width: 4; stroke: chartreuse; fill:rgb(238, 9, 9); fill-opacity:0.5;" />
                        <text x="50" y="50" style="font-family:sans-serif; font-size: 16px;">Swasta</text>
                    </svg>
                </div>
            </div>

            <div id="lgndAdministrasi">
                <h4 class="test-center">Batas Administrasi<i id="btnAdministrasi" class="fa fa-server"></i></h4>
                <div id="lgndAdministrasiDetail">
                    <svg height="180" width="100%">
                        <line x1="10" y1="10" x2="60" y2="10"
                            style="stroke:#C71585; stroke-width:5; stroke-dasharray: 7,5,3,5;" />
                        <text x="65" y="15" style="font-family:sans-serif; font-size:16px;">Batas Kabupaten</text>
                        <line x1="10" y1="40" x2="60" y2="40"
                            style="stroke:Red; stroke-width:3; stroke-dasharray: 7,5,3,5,3,5;" />
                        <text x="65" y="45" style="font-family:sans-serif; font-size:16px;">Batas Desa</text>
                        <line x1="10" y1="70" x2="60" y2="70"
                            style="stroke:Red; stroke-width:3; stroke-dasharray: 7,5,3,5,3,5;" />
                        <text x="65" y="75" style="font-family:sans-serif; font-size:16px;">Batas RW</text>
                        <line x1="10" y1="100" x2="60" y2="100"
                            style="stroke:Red; stroke-width:1.5; stroke-dasharray: 7,5,3,5,3,5,3,5;" />
                        <text x="65" y="105" style="font-family:sans-serif; font-size:16px;">Batas RT</text>
                        <line x1="10" y1="130" x2="60" y2="130"
                            style="stroke:#32CD32; stroke-width:1.5; stroke-dasharray: 5,5;" />
                        <text x="65" y="135" style="font-family:sans-serif; font-size:16px;">Batas Hutan</text>
                        <line x1="10" y1="160" x2="60" y2="160"
                            style="stroke:red; stroke-width:1.5; stroke-dasharray: 5,5;" />
                        <text x="65" y="165" style="font-family:sans-serif; font-size:16px;">Batas
                            Kabupaten-Usulan</text>

                    </svg>
                </div>
            </div>
            <div id="lgndInfrastruktur">
                <h4 class="test-center">Infrastruktur<i id="btnInfrastruktur" class="fa fa-server"></i></h4>
                <div id="lgndInfrastrukturDetail">
                    <svg height="210" width="100%">
                        <line x1="10" y1="10" x2="60" y2="10" style="stroke:red; stroke-width:6;" />
                        <text x="65" y="15" style="font-family:sans-serif; font-size:16px;">Jalan Provinsi</text>
                        <line x1="10" y1="40" x2="60" y2="40" style="stroke:orange; stroke-width:4;" />
                        <text x="65" y="45" style="font-family:sans-serif; font-size:16px;">Jalan Kabupaten</text>
                        <line x1="10" y1="70" x2="60" y2="70" style="stroke:orange; stroke-width:2;" />
                        <text x="65" y="75" style="font-family:sans-serif; font-size:16px;">Jalan Desa</text>
                        <line x1="10" y1="100" x2="60" y2="100" style="stroke:deeppink; stroke-width:4;" />
                        <text x="65" y="105" style="font-family:sans-serif; font-size:16px;">Jembatan</text>
                        <line x1="10" y1="130" x2="60" y2="130" style="stroke:rgb(166, 166, 226); stroke-width:2;" />
                        <text x="65" y="135" style="font-family:sans-serif; font-size:16px;">Irigasi</text>
                        <line x1="10" y1="160" x2="60" y2="160"
                            style="stroke:blue; stroke-width:2; stroke-dasharray: 5,5;" />
                        <text x="65" y="165" style="font-family:sans-serif; font-size:16px;">Pipa PDAB</text>
                        <line x1="10" y1="190" x2="60" y2="190"
                            style="stroke:violet; stroke-width:3; stroke-dasharray: 5,5;" />
                        <text x="65" y="195" style="font-family:sans-serif; font-size:16px;">Penahan Dinding</text>
                    </svg>
                </div>
            </div>
            <div id="lgndLanduse">
                <h4 class="test-center">Penggunaan Lahan<i id="btnLanduse" class="fa fa-server"></i></h4>
                <div id="lgndLanduseDetail">
                    <svg height="210" width="100%">
                        <rect x="10" y="5" width="30" height="20" style=" fill:#FFA500; fill-opacity:0.5; " />
                        <text x="50" y="20" style="font-family:sans-serif; font-size:16px;">pemukiman</text>
                        <rect x="10" y="35" width="30" height="20" style=" fill:#00FFFF; fill-opacity:0.5; " />
                        <text x="50" y="50" style="font-family:sans-serif; font-size:16px;">Pertanian</text>
                        <rect x="10" y="65" width="30" height="20" style=" fill:#a52a2a; fill-opacity:0.5; " />
                        <text x="50" y="80" style="font-family:sans-serif; font-size:16px;">pendidikan</text>
                        <rect x="10" y="95" width="30" height="20" style=" fill:#FF7F50; fill-opacity:0.5; " />
                        <text x="50" y="110" styIe="font-family:sans-serif; font-size:16px;">peribadatan</text>
                        <rect x="10" y="125" width="30" height="20" style="fill:#FF0000; fill-opacity:0.5; " />
                        <text x="50" y="140" style="font-family:sans-serif; font-size:16px;">perkantoran</text>
                        <rect x="10" y="155" width="30" height="20" style=" fill:#FF1493; fill-opacity:0.5; " />
                        <text x="50" y="170" style="font-family:sans-serif; font-size:16px;" :>sarana olah raga</text>
                        <rect x="10" y="185" width="30" height="20" style=" fill:#2E8B57; fill-opacity:0.5; " />
                        <text x="50" y="200" style="font-family:sans-serif; font-size:16px;" :>makam</text>

                    </svg>
                </div>
            </div>

            <div class="lgndHutan">
                <h4 class="test-center">Hutan <i id="btnHutan" class="fa fa-server"></i></h4>
                <div class="lgndHutan">
                    <svg height="150" width="100%">
                        <rect x="10" y="5" width="30" height="20" style=" fill:#228b22; fill-opacity:0.5; " />
                        <text x="50" y="20" style="font-family:sans-serif; font-size:16px;">Hutan Lindung </text>
                        <rect x="10" y="35" width="30" height="20" style=" fill:#800080; fill-opacity:0.5; " />
                        <text x="50" y="50" style="font-family:sans-serif; font-size:16px;">Cagar alam</text>
                        <rect x="10" y="65" width="30" height="20" style=" fill:#00FA9A; fill-opacity:0.5; " />
                        <text x="50" y="80" style="font-family:sans-serif; font-size:16px;">hutan produksi
                            terbatas</text>
                        <rect x="10" y="95" width="30" height="20" style=" fill:#adff2f; fill-opacity:0.5; " />
                        <text x="50" y="110" styIe="font-family:sans-serif; font-size:16px;">hutan produksi</text>
                        <rect x="10" y="125" width="30" height="20" style="fill:#f5deb3; fill-opacity:0.5; " />
                        <text x="50" y="140" style="font-family:sans-serif; font-size:16px;">area penggunaan
                            lahan</text>
                    </svg>
                </div>
            </div>
        </div>
       <!-- Menu Searching Rumah -->

       <div class="col-xs-12" id="div">
        <div class="text-center col-sx-12" id="divSekolahLabel">
            <h4>Pencarian Rumah Berdasarkan ID Sekolah</h4>
        </div>
        <div class="errorMsg col-xs-12" id="divSekolahError"></div>
        <div class="form-group" id="divFindSekolah">
            <div class="col-xs-6"><input type="text" class="form-control" id="txtFindSekolah"
                    placeholder="Masukan ID Sekolah">
            </div>
            <div class="col-xs-6"><button id="btnFindSekolah" class="btn btn-primary btn-block">cari</button>
            </div>
            <div class="divFilterSekolah col-xs-12"></div>
            <div class="col-xs-4"><input type="radio" name="fltSekolah" value="ALL" checked>ALL</div>
            <div class="col-xs-4"><input type="radio" name="fltSekolah" value="Negri" checked>Negri</div>
            <div class="col-xs-4"><input type="radio" name="fltSekolah" value="Swasta" checked>Swasta</div>
        </div>
        <div class="" id="divSekolahData"></div>
    </div>

        <!--//Menu Infrastruktur-->

        <div id="divfilterInfrastruktur" class="col-xs-12">
            <div id="divInfrastrukturLabel" class="text-center col-xs-12">
            </div>
            <div class="" id="divInfrastrukturData"></div>
        </div>

        <!-- TENTANG -->

        <!-- Button Locate -->
        <button id='btnTentang' class='btn btn-primary btn-block'><b>TENTANG</b></button><br>

        <div class="panel p-0 m-0 au-target" id.bind="'vid_'+menuName" ref.bind="'vid_'+menuName" au-target-id="103"
            id="vid_about" style="display:block;">

            <!-- INFO -->
            <div id="content-info" class="contentWrapper">
                <p id="intro">GIS ini adalah hasil kerja sama antara pemerintah kabupaten banjarnegara dan Universitas  Peradaban Bumiayu, dalam rangka mempermudah pendataan, monitoring dan evaluasi <b>Sebaran Sekolah</b> di Kabupaten banjarnegara. Web GIS ini dibuat menggunakan leaflet js, bootstrap, jQUery dan ajax. Seluruh isi dari Web GIS lni menjadi tanggung jawab pemerintah Desa Kaligiri, sekaligus sebagai pihak yang memiliki hak untuk menyiarkan dan mempublikasikan Web GIS ini.</p>
            </div>
        </div>
        <!-- anchor -->
    </div>


    <div id="mapdiv" class="col-md-12"></div>
    <script>
        /*Variabel yang akan digunakan*/
        var mymap;

        var lyrOSM;
        var lyrWatercolor;
        var lyrTopo;
        var lyrImagery;
        var lyrOutdoors;

        var lyrSekolah;
        var lyrAdministrasi;

        var lyrInfrastruktur;
        var lyrLanduse;
        var lyrHutan;
        var lyrSearch;
        var lyrMarkerCluster;

        var ctlLayers;

        var ctlEasybutton;
        var ctlSidebar;
        var ctlPan;
        var ctlMousePosition;
        var ctlMmeasure;
        var ctlAttribute;
        var ctlStyle;
        var ctlLegend;

        var mrkCurrentLocation;

        var objBasemaps;
        var objOverlays;
        var arRumahIDs = [];
        var arAdministrasiIDS = [];

        var arLanduseIDs = [];

        var arInfrastrukturIDs = [];


        /*Function*/
        $(document).ready(function () {
            /*Maps Initalization*/
            mymap = L.map('mapdiv', {
                center: [-7.88373, 110.36899],
                zoom: 13,
                attributionControl: false
            });

            ctlSidebar = L.control.sidebar('side-bar').addTo(mymap);
            ctlEasybutton = L.easyButton('glyphicon-transfer', function () {
                ctlSidebar.toggle();
            }).addTo(mymap);


            ctlAttribute = L.control.attribution().addTo(mymap);
            ctlAttribute.addAttribution('OSM');

            ctlScale = L.control.scale({
                position: 'bottomleft',
                metric: false,
                maxWidth: 200
            }).addTo(mymap);
            ctlMouseposition = L.control.mousePosition().addTo(mymap);
            ctlStyle = L.control.styleEditor({
                position: 'topright',
                openOnLeafletDraw: false
            }).addTo(mymap);
            ctlMeasure = L.control.polylineMeasure().addTo(mymap);

            /*layer Initialization*/
            /*Layer Basemaps*/
            lyrOSM = L.tileLayer.provider('OpenStreetMap.Mapnik');
            lyrTopo = L.tileLayer.provider('OpenTopoMap');
            lyrImagery = L.tileLayer.provider('Esri.WorldImagery');
            lyrOutdoors = L.tileLayer.provider('Thunderforest.Outdoors');
            lyrWatercolor = L.tileLayer.provider('Stamen.Watercolor');
            mymap.addLayer(lyrOSM);

            fgpDrawnItems = new L.FeatureGroup();
            fgpDrawnItems.addTo(mymap);

            /*Layer Utama*/
            lyrSekolah = L.geoJSON.ajax('data/Smp.geojson', {
                pointToLayer: returnSekolahMarker,
                filter: filterSekolah
            }).addTo(mymap);

            lyrSekolah.on('data:loaded', function(){
                    arSekolahIDs.sort(function(a,b){return a-b});
                    $("#txtFindSekolah").autocomplete({
                        source:arSekolahIDs
                    });
                });

            lyrSekolah.on('data:loaded', function () {
                arSekolahIDs.sort(function (a, b) {
                    return a - b
                });
                $("#txtFindRumah").autocomplete({
                    source: arSekolahIDs
                });
            });

            /*Layer Batas Administrasi*/
            lyrAdministrasi = L.geoJSON.ajax('data/Administrasi.geojson', {
                style: styleAdministrasi
            }).addTo(mymap);
            lyrAdministrasi.on('data:loaded', function () {
            });

            /*Layer Infrastruktur*/
            lyrInfrastruktur = L.geoJSON.ajax('data/Infrastruktur.geojson', {
                style: styleInfrastruktur,
                onEachFeature: processInfrastruktur,
                filter: filterInfrastruktur
            }).addTo(mymap);
            lyrInfrastruktur.on('data:loaded', function () {
                arInfrastrukturIDs.sort(function (a, b) {
                    return a - b
                });
                $("#txtFindInfrastruktur").autocomplete({
                    source: arInfrastrukturIDs
                })
            })

            /*Layer Landuse*/
            lyrLanduse = L.geoJSON.ajax('data/landuse3.geojson', {
                style: styleLanduse
            }).addTo(mymap);
            lyrLanduse.on('data:loaded', function () { });

            /*Layer Hutan*/
            lyrHutan = L.geoJSON.ajax('data/hutan1.geojson', {
                style: styleHutan
            }).addTo(mymap);
            lyrHutan.on('data:loaded', function () { });

            /*Setup Layer Control*/
            objBasemaps = {
                "Open Street Maps": lyrOSM,
                "Topo Map:": lyrTopo,
                "Imagery": lyrImagery,
                "Outdoors": lyrOutdoors,
                "Watercolor": lyrWatercolor
            };

            objOverlays = {
                "Rumah": lyrRumah,
                "Batas Administrasi": lyrAdministrasi,
                "Infrastruktur": lyrInfrastruktur,
                "Landuse": lyrLanduse,
                "Hutan": lyrHutan,
                "Batas Administrasi": lyrAdministrasi
            };

            ctlLayers = L.control.layers(objBasemaps, objOverlays).addTo(mymap);
            mymap.on('overlayadd', function (e) {
                var strDiv = "#lgnd" + stripSpaces(e.name);
                $(strDiv).show();
            });

            mymap.on('overlayremove', function (e) {
                var strDiv = "#lgnd" + stripSpaces(e.name);
                $(strDiv).hide();
            });

            // ***** Kode dibawah adalah untuk legend float

            $(".legend-container").append($("#legend"));
            $(".legend-toggle").append($(
                "<i class='legend-toggle-icon fa fa-server fa-2x' style= color:#000'></i>"));

            // ****Location Event****

            mymap.on(locationfound, function (e) {
                console.log(e);
                if (mrkCurrentLocation) {
                    mrkCurrentLocation.remove();
                }
                mrkCurrentLocation = L.circle(e.lating, {
                    radius: e.accuracy / 2
                }).addTo(mymap);
                mymap.setView(e.lating, 14);
            });

            mymap.on('locationerror', function (e) {
                console.log(e);
                alert("location was not found");
            });

            /*Functions*/
            /*Sekolah function*/

            $("btnSekolah").click(function () {
                $("lgndSekolahDetail").toggle();
            });

            /*fungsi marker sekolah */
            function returnSekolahMarker(json, lating) {
                var att = json.properties;
                if (att.status == 'Negri') {
                    var clrSekolah = 'deeppink';
                } else {
                    var clrSekolah = 'lightgreen';
                }
                return L.circleMarker(lating, {
                    radius: 7,
                    color: clrSekolah
                }).bindTootip("<h4>ID Sekolah:" + att.ID_Sekolah + "</h4><h4>Nama Sekolah:" + att.Name +
                    "</4>status:" + att.Status);
            }

            function filterSekolah(json) {
                var att = json.properties;
                var optFilter = $("input[name=fltSekolah]:checked").val();
                if (optFilter == 'ALL') {
                    return true;
                } else {
                    return (att.status == optFilter);
                }
            }

            $("#txtFindSekolah").on('kyup paste', function () {
                var val = $("txtFindSekolah").val();
                testLayerAttribute(arSekolahIDs, val, "ID_Sekolah", "#divFindSekolah", "divSekolahError",
                    "#btnFindSekolah");
            });

            // Fungsi Pencarian Sekolah
            $("#btnFind").clicSekolahk(function () {
                var val = $("#txtFindSekolah").val();
                var lyr = returnLayerByAttribute(lyrSekolah, 'ID_Sekolah', val);
                if (lyr) {
                    if (lyrSearch) {
                        lyrSearch.remove();
                    }
                    lyrSearch = L.circle(lyr.getLatLng(), {
                        radius: 10,
                        color: 'red',
                        weight: 10,
                        opacity: 0.5,
                        fillOpacity: 0
                    }).addTo(mymap);
                    mymap.setView(lyr.getLatLng(), 25);
                    var att = lyr.feature.properties;
                    $("#divSekolahData").html("<h4 class='text-left'>Keterangan</4><h5>Status Sekolah:" +
                        att.Status + "</h5><h5>Nama:" + att.Name + "</h5><h5>ID Sekolah:" + att.ID_Sekolah +"</h5>");
                    $("#divSekolahError").html("");

                    fgpDrawItems.clearLayers();
                    fgpDrawnItems.addLayer(lyr);

                } else {
                    $("#divSekolahError").html("**** No ID Sekolah Tidak Ditemukan ****");
                }
            });

            $("input[name=fltSekolah]").click(function () {
                arSekolahIDs = [];
                lyrSekolah.refresh();
            });

            /*polyline function*/

            $("#btnAdministrasi").click(function () {
                $("#lgndAdministrasiDetail").toggle();
            });

            function styleAdministrasi(json) {
                var att = json.properties;
                switch (att.type) {
                    case 'Batas Kabupaten':
                        return {
                            color: '#C71585', weight: "5", dashArray: "10,7,1,7"
                        };
                        break;
                    case 'Batas Desa':
                        return {
                            color: 'Red', weight: "3", dashArray: "10,7,1,7,1,7"
                        };
                        break;
                    case 'Batas RW':
                        return {
                            color: '#Red', weight: "2.5", dashArray: "10,7,1,7,1,7,1,7"
                        };
                        break;
                    case 'Batas RT':
                        return {
                            color: 'Red', weight: "1.5", dashArray: "10,7,1,7,1,7,1,7,1,7"
                        };
                        break;
                    case 'Batas Hutan':
                        return {
                            color: '#32CS32', weight: "3", dashArray: "5,5"
                        };
                        break;
                    case 'Usulan Batas Kabupaten':
                        return {
                            color: 'Red', weight: "4", dashArray: "5,7"
                        };
                        break;
                }
            }

            $("#btnLgdinfrastruktur").click(function () {
                $("#lgndInfrastrukturDetail").toggle();
            });

            function styleInfrastruktur(json) {
                var att = json.properties;
                switch (att.project) {
                    case 'Jalan Propinsi':
                        return {
                            color: 'Red', weight: "6", dashArray: "0.6"
                        };
                        break;
                    case 'Jalan Kabupaten':
                        return {
                            color: 'orange', weight: "4", dashArray: "0.6"
                        };
                        break;
                    case 'Jalan Desa':
                        return {
                            color: 'orange', weight: "2", dashArray: "0.6"
                        };
                        break;
                    case 'Jembatan':
                        return {
                            color: 'Red', weight: "6", dashArray: "0.6"
                        };
                        break;
                    case 'Irigasi':
                        return {
                            color: 'blue', weight: "6", dashArray: "5,5"
                        };
                        break;
                    case 'Pipa PDAB':
                        return {
                            color: 'blue', weight: "6", dashArray: "5,5"
                        };
                        break;
                    case 'Penahan Dinding':
                        return {
                            color: 'black', weight: "6", dashArray: "5.5"
                        };
                        break;
                }
            }

            function processInfrastruktur(json, lyr) {
                var att = json.properties;
                lyr.bindTooltip("<h4>Infrastruktur:" + att.project + "</h4>Type:" + att.type +
                    "<br>ROW Width:" + att
                        .row_width + "<br>Lenghth:" + returnMultiLength(lyr.getLatLngs()).toFixed(0));
                arInfrastrukturIDs.push(att.project.toString());
            }

            function filterInfrastruktur(json) {
                var arProjectFilter = [];
                $("input[name=fltProject]").each(function () {
                    if (this.checked) {
                        arInfrastrukturFilter.push(this.value);
                    }
                });
                var att = json.properties;
                switch (att.type) {
                    case "Jalan Propinsi":
                        return (arProjectFilter.indexOf('Jalan Propinsi') >= 0);
                        break;
                    case "Jalan Kabupaten":
                        return (arProjectFilter.IndexOf('Jalan Kabupaten') >= 0);
                        break;
                    case "Jalan Desa":
                        return (arProjectFilter.IndexOf('Jalan Desa') >= 0);
                        break;
                    case "Jembatan":
                        return (arProjectFilter.IndexOf('Jembatan') >= 0);
                        break;
                    case "Irigasi":
                        return (arProjectFilter.IndexOf('Irigasi') >= 0);
                        break;
                    case "Pipa PDAB":
                        return (arProjectFilter.IndexOf('Pipa PDAB') >= 0);
                        break;
                    case "Penahan Dinding":
                        return (arProjectFilter.IndexOf('Penahan Dinding') >= 0);
                        break;
                }
            }

            $("#txtFindProject").on('keyup paste', function () {
                var val = $("#txtFindProject").val();
                testLayerAttribute(arInfrastrukturIDs, val, "PROJECT ID", "#divFindProject",
                    "#divProjectError",
                    "#btnFindProject");
            });

            $("#btnFindProject").click(function () {
                var val = $("#txtFindProject").val();
                var lyr = returnLayerByAttribute(lyrInfrastruktur, 'Project'.val);
                if (lyr) {
                    if (lyrSearch) {
                        lyrSearch.remove();
                    }
                    lyrSearch = L.geoJSON(lyr.toGeoJSON(), {
                        style: {
                            color: 'red',
                            weight: 10,
                            opacity: 05
                        }
                    }).addTo(mymap);
                    mymap.fitBounds(lyr.getBounds().pad(1));
                    var att = lyr.feature.properties;
                    $("#divProjectData").html("<h4> class='text-center'>Attributes</h4><h5>Type:" + att
                        .type +
                        "</h5><h5>ROW width:" + att.row_width + "m</h5>");
                    $("divProjectError").html("");

                    fgpDrawItems.clearLayers();
                    fgpDrawItems.addLayer(lyr);

                } else {
                    $("#divProjectError").html("**** Project ID not found ****");
                }
            });

            $("#lblProject").click(function () {
                $("#divProjectData").toggle();
            });

            $("#btnProjectFilterAll").click(function () {
                $("input[name=fltProject]").prop('checked', true);
            });

            $("#btnProjectFilterNone").click(function () {
                $("input[name=fltProject]").prop('checked', false);
            });

            $("#btnProjectFilter").click(function () {
                arInfrastrukturIDs = [];
                lyrInfrastruktur.refresh();
            });

            /*polygon function*/
            $("#B=btnLanduse").click(function () {
                $("#lgndLanduseDetail").toggle();
            });

            function styleLanduse(json) {
                var att = json.properties;
                switch (att.landuse) {
                    case 'Permukiman':
                        return {
                            color: '#FFA500', weight: "0", fillOpacity: "0.7"
                        };
                        break;
                    case 'Pertanian':
                        return {
                            color: '#00FFFF', weight: "0", fillOpacity: "0.7"
                        };
                        break;
                    case 'Pendidikan':
                        return {
                            color: '#A52A2A', weight: "0", fillOpacity: "0.7"
                        };
                        break;
                    case 'Peribadatan':
                        return {
                            color: '#FF7F50', weight: "0", fillOpacity: "0.7"
                        };
                        break;
                    case 'Perkantoran':
                        return {
                            color: '#FF0000', weight: "0", fillOpacity: "0.7"
                        };
                        break;
                    case 'Sarana Olah Raga':
                        return {
                            color: '#FF1493', weight: "0", fillOpacity: "0.7"
                        };
                        break;
                    case 'Makam':
                        return {
                            color: '#2E8B57', weight: "0", fillOpacity: "0.7"
                        };
                        break;
                }
            }

            $("#btnHutan").click(function () {
                $("#lgndHutanDetail").toggle();
            });

            function styleHutan(json) {
                var att = json.properties;
                switch (att.type) {
                    case 'Hutan Lindung':
                        return {
                            color: '#228B22', weight: "0", fillOpacity: "0.4"
                        };
                        break;
                    case 'Hutan Produksi':
                        return {
                            color: '#ADFF2F', weight: "0", fillOpacity: "0.4"
                        };
                        break;
                    case 'Hutan Produksi Terbatas':
                        return {
                            color: '#00FA9A', weight: "0", fillOpacity: "0.4"
                        };
                        break;
                    case 'Cagar Alam':
                        return {
                            color: '#800080', weight: "0", fillOpacity: "0.7"
                        };
                        break;
                    case 'Area Penggunaan Lain':
                        return {
                            color: '#F5DEB3', weight: "0", fillOpacity: "0.7"
                        };
                        break;
                }
            }

            /*jQuery Function*/

            $("#btnLocate").click(function () {
                mymap.locate();
            });
            $("#btnShowLegend").click(function () {
                $("#legend").toggle();
            });

            /*General Function*/

            function LatLngToArrayString(ll) {
                return "[" + ll.lat.toFixed(5) + "," + ll.lng.toFixed(5) + "]";
            }

            function returnLayerByAttribute(lyr, att, val) {
                var arLayers = lyr.getLayers();
                for (i = 0; i < arLayers.length - 1; i++) {
                    var ftrVal = arLayers[i].feature.properties[att];
                    if (ftrVal == val) {
                        return arLayers[i];
                    }
                }
                return false;
            }

            function testLayerAttribute(ar, val, att, fg, err, btn) {
                if (ar.indexOf(val) < 0) {
                    $(fg).addClass("has-error");
                    $(err).html("****" + att + "NOT FOUND ****");
                    $(btn).attr("disabled", true);
                } else {
                    $(fg).removeClass("has-error");
                    $(err).html("");
                    $(btn).attr("disabled", false);
                }
            }

            function returnLength(arLL) {
                var total = 0;

                for (var i = 1; i < arLL.length; i++) {
                    total = total + arLL[i - 1].distanceTo(arLL[i]);
                }
                return total;
            }

            function returnMultiLength(arArLL) {
                var total = 0;

                for (var i = 0; i < arArLL.length; i++) {
                    total = total + returnLength(arArLL)[i];
                }
                return total;
            }

            function returnCloseslayer(lyrGroup, llRef) {
                var arLyrs = lyrGroup.getLayers();
                var nearest = L.GeometryUtil.closestLayer(mymap, arLyrs, llRef);
                nearest.distance = llRef.distanceTo(nearest.latlng);
                nearest.bearing = L.GeometryUtil.bearing(llRef, nearest.latlng);
                if (nearest.bearing < 0) {
                    nearest.bearing = nearest.bearing + 360;
                }
                nearest.att = nearest.layer.feature.properties;
                return nearest;
            }
        });
    </script>
</body>

</html>